function startTime(){setLocation(station_location),setTimeout("startTime()",500)}function setDOW(e){dayofweek=e,dayofweek==0?day=2:dayofweek==6?day=1:day=0}function setLocation(e){$(".alert-info").removeClass("alert-info"),$("#location"+e).addClass("alert-info"),setDOW((new Date).getDay()),station_location=e,station_location==0?direction==1&&toggleDirection():station_location==4&&direction==0&&toggleDirection(),data&&(station_id=direction==0?data[day][direction][station_location]:data[day][direction][station_names.length-1-station_location],curr_station_name=station_names[station_location]),getNextTime()}function getNextTime(){curr_station_name||(curr_station_name="Choose a station ");if(station_id){var e=new Date,t=e.getHours(),n=e.getMinutes(),r=e.getSeconds(),i=station_id,s=i.length,o;for(var u=0;u<s;u++){var a=i[u].split(":"),f=parseInt(a[0],10),l=parseInt(a[1],10);o=a;if(f>t)break;if(f==t&&l>n)break}if(o[0]==t&&o[1]<=n||o[0]<t){var c;dayofweek==6?c=2:dayofweek==5?c=1:c=0,direction==0?o=data[c][direction][station_location][0].split(":"):o=data[c][direction][station_names.length-1-station_location][0].split(":")}document.getElementById("next").innerHTML="Next <i class='icon-time'></i>Train at "+o.join(":");var h=getTimeDifference(t,n,r,o[0],o[1],0);document.getElementById("next").innerHTML+=" in "+h[0]+"h:"+h[1]+"m:"+h[2]+"s"}}function getTimeDifference(e,t,n,r,i,s){var o,u,a;return r=r==0?24:r,e=e==0?24:e,o=r-e,u=i-t,a=s-n,u=a<0?u-1:u,a=i-t-1==u?60+a:a,o=u<0?o-1:o,u=r-e-1==o?60+u:u,o=o<0?24+o:o,[o,u,a]}function toggleDirection(){$("#hud").stop(!0,!0);var e=direction;direction==0?(direction=1,$(".arrows").removeClass("icon-arrow-down").addClass("icon-arrow-up")):(direction=0,$(".arrows").removeClass("icon-arrow-up").addClass("icon-arrow-down")),setLocation(station_location),$("#hud").css("display",""),$("#hud").css("opacity",1),$("#hud").fadeTo("slow",0,function(){$("#hud").css("display","none")}),$("#location"+station_location).select()}var data;$.get("times.json",function(e){data=JSON.parse(e)});var station_names=["GREENBORO","CONFEDERATION","CARLETON","CARLING","BAYVIEW"],station_id,curr_station_name,direction=0,station_location,dayofweek,day;document.getElementById("hud").style.top=document.getElementById("locationli2").offsetTop+25+"px",$("#hud").css("display","none");var uvOptions={};(function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://":"http://")+"widget.uservoice.com/9XBoblHGevZr739GvY1dPQ.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})();var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-33989135-1"]),_gaq.push(["_trackPageview"]),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}(),window.addEventListener("load",function(){setTimeout(function(){window.scrollTo(0,1)},0)});